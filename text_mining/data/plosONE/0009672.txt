
  Discover a faster, simpler path to publishing in a high-quality journal. PLOS ONE promises fair, rigorous peer review,
  broad scope, and wide readership – a perfect fit for your research every time.
   
    
     Learn More
    
    
      Submit Now
    
   Click through the PLOS taxonomy to find articles in your field. For more information about PLOS Subject Areas, click
          here.
         Loading metrics Paper's citation count computed by Scopus. Sum of PLOS and PubMed Central page views and downloads. Sum of Facebook and Twitter activity. Open Access Peer-reviewed Research Article Affiliation
    School of Mathematical Sciences, University College Dublin, Dublin, Ireland
   Affiliation
    Centre for Ecology and Conservation, School of Biosciences, University of Exeter, Penryn, Cornwall, United Kingdom
   Affiliation
    Centre for Ecology and Conservation, School of Biosciences, University of Exeter, Penryn, Cornwall, United Kingdom
    * E-mail: A.Jackson@tcd.ie Affiliation
    Department of Zoology, School of Natural Sciences, Trinity College Dublin, Dublin, Ireland
   Stable isotope analysis is increasingly being utilised across broad areas of ecology and biology. Key to much of this work is the use of mixing models to estimate the proportion of sources contributing to a mixture such as in diet estimation. By accurately reflecting natural variation and uncertainty to generate robust probability estimates of source proportions, the application of Bayesian methods to stable isotope mixing models promises to enable researchers to address an array of new questions, and approach current questions with greater insight and honesty. We outline a framework that builds on recently published Bayesian isotopic mixing models and present a new open source R package, SIAR. The formulation in R will allow for continued and rapid development of this core model into an all-encompassing single analysis suite for stable isotope research. Citation: Parnell AC, Inger R, Bearhop S, Jackson AL (2010) Source Partitioning Using Stable Isotopes: Coping with Too Much Variation. PLoS ONE 5(3):
        e9672.
        doi:10.1371/journal.pone.0009672 Editor: Sean Rands, University of Bristol, United Kingdom Received: October 20, 2009; Accepted: February 19, 2010; Published:  March 12, 2010 Copyright:  © 2010 Parnell et al. This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited. Funding: Authors AJ, AP and SB hold faculty positions in their respective institutions. No other funds are directly linked to the work described in this manuscript. RI is funded as a postdoctoral researcher on NERC standard grant NE/F021690/1 http://www.nerc.ac.uk/ The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. Competing interests:  The authors have declared that no competing interests exist. Stable isotope approaches are an important ecological tool, enabling increasingly sophisticated questions to be addressed in a number of fields [1], [2] although the majority of work has been in the area of animal foraging and resource partitioning [e.g. 3]. Much progress has been facilitated by isotopic mixing models which allow researchers to estimate the proportional contribution of sources (dietary items) within a mixture (consumer tissue), and thereby infer diet composition [4], [5]. Numerous approaches to solving isotopic mixing models have been proposed [6], [7], [8], [9], [10], although those developed by Phillips & co-authors have been the most widely embraced. For mathematically determined systems, simple linear mixing models [6] were used to find unique solutions, the assumption being that there is no variability within sources. An extension to these, IsoError [10], allowed variation to be propagated to produce uncertainty within the outputs, being more appropriate in natural systems. In underdetermined systems where the number of sources is greater than the number of isotopes plus one, and no exact solution exists, the standard approach has been to use IsoSource [9] using an iterative algorithm, producing a range of feasible solutions, based on an arbitrary user-defined threshold. Although these approaches have been successful, some recurring issues remain: In general, some existing models can incorporate variability but are constrained by the number of sources, e.g. IsoError [10]. While later models, e.g. IsoSource [9] can cope with multiple sources, they cannot incorporate uncertainty and variation. Perhaps most frustratingly, the outputs from these models represent a range of feasible solutions, with no quantification as to which solutions are most likely. Furthermore, none of these models account for issues 3 & 4 above, particularly variation in TEFs, which can be problematic [11], [12]. Bayesian inference offers to circumvent the limitations indicated above, incorporating many more sources of variability within the model, while allowing for multiple dietary sources and then generating potential dietary solutions as true probability distributions. We present a novel methodology for analysing mixing models implemented in the software package SIAR (Stable Isotope Analysis in R) [13]. SIAR is available to download from the packages section of the Comprehensive R Archive Network site (CRAN) - http://cran.r-project.org/. SIAR is similar in many regards to MixSIR, a recently published Bayesian mixing model [14] which is providing novel insights in a variety of situations [15], [16], [17]. Aside from relatively minor differences in the fitting algorithms implemented in SIAR and MixSIR (SIAR uses MCMC while MixSIR uses Sample Importance Resampling) the two models differ fundamentally such that SIAR includes an overall residual error term lacking from MixSIR [18]. Some debate remains as to the appropriateness of including or omitting the residual error term with arguments for model simplicity favouring omission in some cases [19]. However, we maintain that unknown sources of error on the observed data, beyond that quantified by errors on the sources and the trophic enrichment factors should not be ignored from a philosophical stand-point and a residual term should always be included (as one would routinely expect in any linear model) [20]. First, we outline the algebra for our system. We deal with a generic situation where data comprise N measurements on J isotopes with K sources: The model is formulated as follows:(1)(2)(3)(4)A key advance is that the Bayesian paradigm allows for uncertainty in all the parameters. The two most important here are p and σ2, controlling proportional contribution and residual variance respectively. Model fitting is hierarchical, offering unbounded flexibility in adding complexity. Moreover, the Bayesian approach allows for external (prior) information to be incorporated, further narrowing the precision of estimated dietary proportions. This prior information may be vague or informative, e.g. corresponding to the volume of existing knowledge regarding a priori knowledge about the diet of an animal. A natural prior distribution for pk is the Dirichlet, a generalisation of the Beta distribution [21]. The Dirichlet distribution treats each source input as independent but requires they sum to unity. SIAR allows users to specify prior information on the mean proportions (that sum to unity) for each dietary source and a standard deviation for the first of these proportions; this is used to generate K α values. This external information directs the model according to the user's expert knowledge. The Dirichlet prior does not allow the user to specify individual uncertainties for each proportion, but the prior as input does match exactly what the model receives and uses it to draw consistent proportions [18]. The generated marginal distributions of a Dirichlet distribution with K α values [21] can be explored by defining:(5)and then the characteristics of the distribution are given by:(6)(7)(8)where  and  (and their associated Dirichlet parameters  and ) are the kth and pth dietary proportions. The default SIAR model sets each of the α values to 1. This corresponds to a vague prior with each source having prior mean 1/K and prior variance (K−1)/(K2(K+1)). The Dirichlet-distributed default prior used by SIAR is designed to be vague so that the results are primarily influenced by the data. More informative prior distributions are available as part of the SIAR software. Furthermore, although the Dirichlet prior distribution has a prescribed covariance structure, the posterior distributions may have more complicated structures, yielding important information about how well the model can discriminate between sources. SIAR includes diagnostic matrix plots for exploring this covariance structure. Strong negative correlation between two posterior pk values implies that one source is simply being traded off against the other and the model is unable to isolate the contribution of either in isolation. A vague prior is also assigned to σ. Model fitting is via Markov chain Monte Carlo (MCMC) which produces simulations of plausible values of pk consistent with the data. The estimated values of the parameters after taking into account the data and the prior information are known as posterior distributions, representing a true probability density for the parameters of interest. The R package SIAR allows full access to these posterior densities so that users can create any summary of the output they require. First, we illustrate the model with a simulated example involving 2 unique isotope measurements on 10 organisms whose diets comprise 3 different uncertain sources: A, B and C; in SIAR these are treated as normally distributed. We set TEFs to zero and the concentration dependencies as equal with no loss of generality. Setting the trophic enrichment values to zero mean and zero standard deviation has no bearing on the performance of the model. Adding variation here is mathematically identical to increasing variation on the sources since the variances are combined additively in the formation of the likelihood function:  in equation 9 below. The likelihood function is then used to calculate the probability of the data given the model. Conversely, including a non-zero mean TEF simply offsets the data geometrically in isotope-space and has no other bearing on model performance. We simulate data from a known set of true proportions: 0.75, 0.2 and 0.05 for sources A, B and C respectively. Similarly, by varying the residual error parameter  when generating simulated data, we can see how the model responds to differing levels of uncertainty (Fig 1).  (A) Consumer (open circles and crosses) and source (filled squares) isotope values from two data sets with different between-individual variability in the animal isotope measurements (standard deviation σ = 0.1 for open circles, compared with 0.5 for crosses). (B) Posterior density estimates of the proportions for both models. The true values of the proportions are shown in the vertical lines. In both cases, the true proportions are inside the 95% credibility intervals of the posterior distributions. 
              http://dx.doi.org/10.1371/journal.pone.0009672.g001 Below we outline pseudo-code for generating the data sets used for testing the SIAR coverage properties. The user first has to input the number of data sets required for testing (we used 1000), the number of consumers required for each data set (we use 10), as well as lower and upper limits on the number of sources (we use 3 to 5) and the number of isotopes (we use 2 to 3). Key to the pseudo-code is the likelihood function (which applies when the concentration dependence parameters are set equal q1 = q2… = qk) based on a normal distribution with a mean and variance:(9)Scenario 1 can then be created via the following pseudo-code: Loop dataset number; Repeat for next data set. The values reported in Figure 2 show the estimated proportion of the 1000 data sets inside the 95% credibility interval.  The model performs well for all of the different scenarios considered. The figure shows the deterioration of model predictions as the number of sources is increased. Performance can be improved by increasing the number of isotopes used. 
              http://dx.doi.org/10.1371/journal.pone.0009672.g002 Second, we conduct a fuller examination of the model, picking a selection of ‘reasonable’ scenarios and test how often the simulated true proportions lie inside the 95% credible intervals of the estimates. Clearly, it is impossible to examine all possible scenarios; the 3 we consider are: These more complex scenarios of the sensitivity analysis are easily re-created by adapting the above steps for the simple case by altering the distributions of random variables and averaging across sources when combining the two nearest sources. In each case, 1000 simulated data sets of 10 target organism values were produced for data with between 2 and 3 isotopes and 3 and 5 sources. SIAR performs extremely well (Fig 2), given that some simulations, by chance, represent biological extremes. The model performs increasingly poorly as the number of sources increases (Fig 1). However, increasing the number of isotopes sustains the predictive power of the model as the number of sources increase. The model even performs acceptably in scenarios 2 and 3 where some key model assumptions are violated. SIAR works exceptionally well for numerous datasets, appearing robust to violations of its core assumptions (Figs 1 & 2). Users can therefore be confident of the estimated dietary composition of consumers, even in underdetermined systems. Further, they can be assured that uncertainty and variation in parameters is included in these estimates, meaning that we now have a tool to investigate complex dietary systems with greater quantitative rigour than before. Additionally, SIAR includes capability for inclusion of concentration dependence which has shown to be an essential consideration in some circumstances [20]. The Bayesian approach naturally propagates sources of uncertainty into posterior probability distributions, and as such we can make statements about which solutions are more likely than others, allowing us to use these estimates in down-stream statistical models such as relating proportion of a particular source to another measured parameter of interest such as fitness. Ideally one would bolt another Bayesian model onto the SIAR output and use the full posterior distribution. However, such techniques are not currently widely available to ecologists. Instead, since the posterior contains information on which parameters are more likely than others, a measure of central tendency (preferably the mode) could be used and passed into standard frequentist generalised linear models, particularly if the posterior distributions of interest are precise and not highly skewed. We caution users to be aware that the posterior dietary proportion estimates may be highly uncertain and that single summary values (such as the modes) should be used with care. There is also no reason to expect the modes of the marginal posterior distributions to sum-to-unity: something that is not an issue if the full posterior distribution is used in down-stream analyses. Not surprisingly there are caveats to consider before applying SIAR (several that are common to all mixing models). Some of these are: Recent quantitative advances allow comparison of community structure based on isotope data alone – in δ-space [23], [24]. However, now that Bayesian approaches can yield robust estimates of diet, the prospect of using diet composition to describe community structure (i.e. in p-space) [25], and quantifying competition arising in overlapping niches is becoming a real possibility. In most instances it will be the causes or consequences of dietary differences that are of interest to the researcher. The Bayesian approach allows further development via the model output, for example the inclusion of the dietary proportions with their uncertainty in generalised linear models to relate diet with other explanatory variables such as the inclusion of random effects in MixSIR [26]. Furthermore, these mixing models are equally applicable to other mixing problems such as identifying pollution sources. SIAR potentially opens up a host of possibilities for addressing key ecological questions and we envisage it developing continually as open-source software, becoming a holistic resource for performing a range of generic analyses relating to stable isotope techniques. We are grateful to Carlos Martinez Del Rio, Don Phillips and Brian Fry for discussion and insight which greatly improved this paper. Conceived and designed the experiments: ACP RI SB ALJ. Performed the experiments: ACP. Analyzed the data: ACP ALJ. Contributed reagents/materials/analysis tools: ACP ALJ. Wrote the paper: ACP RI SB ALJ. For more information about PLOS Subject Areas, click
          here. Is the Subject Area "Normal distribution" applicable to this article?
          Yes
          No Thanks for your feedback. Is the Subject Area "Isotopes" applicable to this article?
          Yes
          No Thanks for your feedback. Is the Subject Area "Isotope analysis" applicable to this article?
          Yes
          No Thanks for your feedback. Is the Subject Area "Stable isotopes" applicable to this article?
          Yes
          No Thanks for your feedback. Is the Subject Area "Diet" applicable to this article?
          Yes
          No Thanks for your feedback. Is the Subject Area "Simulation and modeling" applicable to this article?
          Yes
          No Thanks for your feedback. Is the Subject Area "Theoretical ecology" applicable to this article?
          Yes
          No Thanks for your feedback. Is the Subject Area "Probability distribution" applicable to this article?
          Yes
          No Thanks for your feedback. 

 

       Publications plos.org Blogs Collections Send us feedback Help using this site LOCKSS PLOS is a nonprofit 501(c)(3) corporation, #C2354500, and is based in San Francisco, California, US